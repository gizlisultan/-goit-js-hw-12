{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-function.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["function galleryMarkup(arr) {\n    return arr\n        .map(\n            ({ webformatURL,\n                largeImageURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads, }) => `\n  <li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${webformatURL}\"\n      alt=\"${tags}\"\n    />\n    <p class= \"gallery-descr\">• Likes: ${likes} • Views: ${views} • Comments: ${comments} •</span> Downloads:${downloads}</p>\n  </a>\n</li>\n  `)\n    .join(\"\")\n}\n\nexport { galleryMarkup };","export {URL,KEY}\n\nconst URL = \"https://pixabay.com/api\"\nconst KEY = \"42188740-c0be7e81c485970d884fe2cff\"","\n\nimport axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { galleryMarkup} from \"./js/render-function.js\";\nimport { URL , KEY } from \"./js/pixabay-api.js\";\n\n\nconst form = document.querySelector(\".search-form\")\nconst galleryUl = document.querySelector(\".gallery\")\nconst loader = document.querySelector('.loader')\nconst loadMoreBtn = document.querySelector('.load-btn');\n\n\nconst serverRequest = `${URL}?key=${KEY}`\n\nconst hiddenClass=  \"is-hidden\";\nlet searchItem = \"\";\nlet page = 1;\nlet maxPage = 0;\n\n\n\nform.addEventListener(\"submit\", searchImg)\nloader.style.display = \"none\";\n\n\nfunction searchImg(evt) {\n    evt.preventDefault()\n    loader.style.display = \"block\"\n    searchItem = evt.currentTarget.elements.query.value;\n    fetchPhoto(searchItem).then((data) => {\n        loader.style.display = \"none\"\n        if (!data.hits.length) {\n            iziToast.error({\n                title: \"Error\",\n                message:\n                    \"Sorry, there are no images matching your search query. Please try again!\",   \n            }), loadMoreBtn.classList.add(hiddenClass)\n        }\n        galleryUl.innerHTML = \"\";\n        page = 1;\n        try {\n               \n        \n            galleryUl.innerHTML = galleryMarkup(data.hits)\n            const refreshPage = new SimpleLightbox(\".gallery a\", {\n                captionsData: \"alt\",\n                captionDelay: 250,\n            });\n            refreshPage.refresh(), scrollBy();\n            if (data.totalHits >= 15) {\n                loadMoreBtn.classList.remove(hiddenClass);\n                loadMoreBtn.addEventListener(\"click\", handleLoadMore);\n            } else {\n                loadMoreBtn.classList.add(hiddenClass);\n            }\n\n        }\n        catch (err) { iziToast.error(err) } finally {\n            form.reset();\n            if (page === maxPage) {\n                loadMoreBtn.classList.add(hiddenClass);\n            }\n        };\n    },)\n}\n\n        function fetchPhoto(photo, page = 1) {\n            return axios.get(`${URL}`, {\n                params: {\n                    key: KEY,\n                    q: photo,\n                    image_type: \"photo\",\n                    orientation: \"horizontal\",\n                    safesearch: true,\n                    per_page: 15,\n                    page,\n                }\n            }).then(({ data }) => data)\n        }\n        /*\n            return fetch(`${serverRequest}&q=${photo}&image_type=photo&orientation=horizontal&safesearch=true`)\n                .then((photo) => {\n                    if (!photo.ok) {\n                        throw new Error(photo.statusText)\n                    }\n                    return photo.json()\n                }).catch((err) => console.log(err))\n        }*/\n\n        async function handleLoadMore() {\n            page += 1;\n \n            loadMoreBtn.disabled = true;\n            try {\n                const { hits, total } = await fetchPhoto(searchItem, page);\n\n                maxPage = Math.ceil(total / 15);\n    \n    \n                galleryUl.insertAdjacentHTML(\"beforeend\", galleryMarkup(hits));\n                const refreshPage = new SimpleLightbox(\".gallery a\", {\n                 captionsData: \"alt\",\n                  captionDelay: 250,\n                 });\n                refreshPage.refresh();\n                scrollBy()\n            } catch (error) {\n                onFetchError(error);\n            } finally {\n  \n                loadMoreBtn.disabled = false;\n                if (page === maxPage) {\n                    loadMoreBtn.classList.add(hiddenClass);\n                    loadMoreBtn.removeEventListener(\"click\", handleLoadMore)\n                    iziToast.error({\n                        title: \"Error\",\n                        message:\n                            \"You've reached the end of search results.\",\n                    });\n  \n                }\n            }\n        }\n \n\n        function scrollBy() {\n            window.scrollBy({\n                top: 700,\n                behavior: 'smooth',\n            });\n        }"],"names":["galleryMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","URL","KEY","form","galleryUl","loader","loadMoreBtn","hiddenClass","searchItem","page","maxPage","searchImg","evt","fetchPhoto","data","iziToast","SimpleLightbox","scrollBy","handleLoadMore","err","photo","axios","hits","total","error"],"mappings":"owBAAA,SAASA,EAAcC,EAAK,CACxB,OAAOA,EACF,IACG,CAAC,CAAE,aAAAC,EACC,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CAAY,IAAK;AAAA;AAAA,kCAECL,CAAa;AAAA;AAAA;AAAA,aAGlCD,CAAY;AAAA,aACZE,CAAI;AAAA;AAAA,yCAEwBC,CAAK,aAAaC,CAAK,gBAAgBC,CAAQ,uBAAuBC,CAAS;AAAA;AAAA;AAAA,GAGrH,EACE,KAAK,EAAE,CACZ,CCpBA,MAAMC,EAAM,0BACNC,EAAM,qCCSNC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,WAAW,EAKhDC,EAAc,YACpB,IAAIC,EAAa,GACbC,EAAO,EACPC,EAAU,EAIdP,EAAK,iBAAiB,SAAUQ,CAAS,EACzCN,EAAO,MAAM,QAAU,OAGvB,SAASM,EAAUC,EAAK,CACpBA,EAAI,eAAgB,EACpBP,EAAO,MAAM,QAAU,QACvBG,EAAaI,EAAI,cAAc,SAAS,MAAM,MAC9CC,EAAWL,CAAU,EAAE,KAAMM,GAAS,CAClCT,EAAO,MAAM,QAAU,OAClBS,EAAK,KAAK,SACXC,EAAS,MAAM,CACX,MAAO,QACP,QACI,0EACP,CAAA,EAAGT,EAAY,UAAU,IAAIC,CAAW,GAE7CH,EAAU,UAAY,GACtBK,EAAO,EACP,GAAI,CAGAL,EAAU,UAAYZ,EAAcsB,EAAK,IAAI,EACzB,IAAIE,EAAe,aAAc,CACjD,aAAc,MACd,aAAc,GAC9B,CAAa,EACW,UAAWC,IACnBH,EAAK,WAAa,IAClBR,EAAY,UAAU,OAAOC,CAAW,EACxCD,EAAY,iBAAiB,QAASY,CAAc,GAEpDZ,EAAY,UAAU,IAAIC,CAAW,CAG5C,OACMY,EAAK,CAAEJ,EAAS,MAAMI,CAAG,CAAC,QAAW,CACxChB,EAAK,MAAK,EACNM,IAASC,GACTJ,EAAY,UAAU,IAAIC,CAAW,CAErD,EACO,CACP,CAEQ,SAASM,EAAWO,EAAOX,EAAO,EAAG,CACjC,OAAOY,EAAM,IAAI,GAAGpB,CAAG,GAAI,CACvB,OAAQ,CACJ,IAAKC,EACL,EAAGkB,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAX,CACH,CACJ,CAAA,EAAE,KAAK,CAAC,CAAE,KAAAK,CAAI,IAAOA,CAAI,CAC7B,CAWD,eAAeI,GAAiB,CAC5BT,GAAQ,EAERH,EAAY,SAAW,GACvB,GAAI,CACA,KAAM,CAAE,KAAAgB,EAAM,MAAAC,CAAO,EAAG,MAAMV,EAAWL,EAAYC,CAAI,EAEzDC,EAAU,KAAK,KAAKa,EAAQ,EAAE,EAG9BnB,EAAU,mBAAmB,YAAaZ,EAAc8B,CAAI,CAAC,EACzC,IAAIN,EAAe,aAAc,CACpD,aAAc,MACb,aAAc,GAChC,CAAkB,EACU,QAAO,EACnBC,EAAU,CACb,OAAQO,EAAO,CACZ,aAAaA,CAAK,CAClC,QAAsB,CAENlB,EAAY,SAAW,GACnBG,IAASC,IACTJ,EAAY,UAAU,IAAIC,CAAW,EACrCD,EAAY,oBAAoB,QAASY,CAAc,EACvDH,EAAS,MAAM,CACX,MAAO,QACP,QACI,2CAC5B,CAAqB,EAGR,CACJ,CAGD,SAASE,GAAW,CAChB,OAAO,SAAS,CACZ,IAAK,IACL,SAAU,QAC1B,CAAa,CACb"}